# Data Factory Next

> ç»Ÿä¸€æ•°æ®æ¨¡æ‹Ÿä¸æ’­æ”¾æ¶æ„ - å·¥ä¸šæ•°æ®ç”Ÿæˆã€å®æ—¶æ¨¡æ‹Ÿä¸æ•°æ®ç®¡ç†å¹³å°

**Data Factory Next** æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„å·¥ä¸šæ•°æ®ç”Ÿæˆä¸æ¨¡æ‹Ÿå¹³å°ï¼Œå°†æ‰¹é‡æ•°æ®ç”Ÿæˆèƒ½åŠ›å’Œå®æ—¶å‘¨æœŸæ‰§è¡Œèƒ½åŠ›èåˆåˆ°ä¸€å¥—ç»Ÿä¸€çš„æ ¸å¿ƒå¼•æ“ä¸­ã€‚æ”¯æŒå¤šç§è¿è¡Œæ¨¡å¼ã€çµæ´»çš„æ•°æ®ç®¡ç†ï¼Œä»¥åŠå®Œæ•´çš„ OPCUA é›†æˆï¼Œä¸ºå·¥ä¸šå¤§æ¨¡å‹æµ‹è¯•ã€PLC ä»¿çœŸã€æ•°æ®åˆ†æå’Œç³»ç»Ÿé›†æˆæä¾›å¼ºå¤§çš„æ•°æ®æ”¯æ’‘ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ ç»Ÿä¸€æ‰§è¡Œå¼•æ“
- **æœ‰çŠ¶æ€å‘¨æœŸæ‰§è¡Œ**ï¼šé‡‡ç”¨ç»Ÿä¸€çš„æœ‰çŠ¶æ€å‘¨æœŸæ‰§è¡Œæ¨¡å‹ï¼Œç¡®ä¿ç®—æ³•é€»è¾‘ä¸€è‡´æ€§
- **åŒæ¨¡å¼è¿è¡Œ**ï¼š
  - **GENERATOR æ¨¡å¼**ï¼šå¿«é€Ÿæ‰¹é‡ç”Ÿæˆï¼Œä¸ sleepï¼Œé€‚åˆç¦»çº¿æ•°æ®ç”Ÿæˆå’Œæµ‹è¯•
  - **REALTIME æ¨¡å¼**ï¼šå®æ—¶è¿è¡Œï¼ŒæŒ‰å‘¨æœŸ sleepï¼Œé€‚åˆåœ¨çº¿æ¨¡æ‹Ÿå’Œç³»ç»Ÿé›†æˆ
- **çµæ´»é‡‡æ ·æ§åˆ¶**ï¼šæ‰§è¡Œå‘¨æœŸä¸é‡‡æ ·é—´éš”åˆ†ç¦»ï¼Œæ”¯æŒæŒ‰éœ€é‡‡æ ·

### ğŸ“Š å¼ºå¤§çš„æ•°æ®ç®¡ç†
- **å®æ—¶æ•°æ®æ¨é€**ï¼šè‡ªåŠ¨æ¨é€åˆ° Redisï¼Œæ”¯æŒ Pub/Sub é€šçŸ¥æœºåˆ¶
- **å†å²æ•°æ®å­˜å‚¨**ï¼šåŸºäº DuckDB çš„é«˜æ€§èƒ½æ—¶åºæ•°æ®å­˜å‚¨ï¼Œæ”¯æŒæŒ‰é‡‡æ ·å‘¨æœŸå­˜å‚¨
- **æ•°æ®æŸ¥è¯¢æ¥å£**ï¼šæä¾›å†å²æŸ¥è¯¢ã€é‡‡æ ·æŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢å’Œæœ€æ–°å€¼æŸ¥è¯¢
- **OPCUA é›†æˆ**ï¼šç‹¬ç«‹çš„ OPCUA Serverï¼Œè‡ªåŠ¨ä» Redis è¯»å–æ•°æ®å¹¶æ›´æ–°èŠ‚ç‚¹

### ğŸ”§ çµæ´»çš„é…ç½®ç³»ç»Ÿ
- **DSL é…ç½®**ï¼šåŸºäº YAML çš„å£°æ˜å¼é…ç½®ï¼Œæ”¯æŒå¤æ‚çš„æ•°æ®å…³ç³»å®šä¹‰
- **è¡¨è¾¾å¼å¼•æ“**ï¼šæ”¯æŒæ•°å­¦å‡½æ•°ã€æ–¹æ³•è°ƒç”¨ã€å±æ€§è®¿é—®å’Œå†å²æ•°æ®è®¿é—®ï¼ˆ`[-N]` è¯­æ³•ï¼‰
- **åŠ¨æ€èŠ‚ç‚¹åˆ›å»º**ï¼šæ”¯æŒç®—æ³•èŠ‚ç‚¹ã€æ¨¡å‹èŠ‚ç‚¹å’Œè¡¨è¾¾å¼èŠ‚ç‚¹çš„åŠ¨æ€åˆ›å»º

### ğŸ“ˆ æ•°æ®å¯¼å‡ºï¼ˆè§„åˆ’ä¸­ï¼‰
- **å¤šæ ¼å¼æ”¯æŒ**ï¼šæ”¯æŒ CSV å¯¼å‡ºï¼Œå¯é…ç½®æ ‡é¢˜è¡Œã€æè¿°è¡Œå’Œæ—¶é—´æ ¼å¼
- **å¢é‡å¯¼å‡º**ï¼šæ”¯æŒå¤§æ•°æ®é›†çš„å¢é‡å¯¼å‡ºï¼Œé¿å…å†…å­˜æº¢å‡º

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python >= 3.10
- Redisï¼ˆå¯é€‰ï¼Œç”¨äºå®æ—¶æ•°æ®ç®¡ç†ï¼‰
- DuckDBï¼ˆè‡ªåŠ¨å®‰è£…ï¼Œç”¨äºå†å²æ•°æ®å­˜å‚¨ï¼‰

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### åŸºç¡€ä½¿ç”¨

#### 1. æ‰¹é‡æ•°æ®ç”Ÿæˆï¼ˆGENERATOR æ¨¡å¼ï¼‰

```python
import programs  # æ³¨å†Œç¨‹åºç±»å‹
import functions  # æ³¨å†Œå‡½æ•°

from core.parser import DSLParser
from core.engine import UnifiedEngine

# è§£æé…ç½®æ–‡ä»¶
parser = DSLParser()
config = parser.parse_file("config/display_demo.yaml")

# åˆ›å»ºå¼•æ“
engine = UnifiedEngine.from_program_config(config)

# æ‰¹é‡ç”Ÿæˆ 10000 ä¸ªå‘¨æœŸçš„æ•°æ®
results = engine.run_generator(10000)

# results æ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«æ‰€æœ‰å‘¨æœŸçš„å¿«ç…§
print(f"ç”Ÿæˆäº† {len(results)} ä¸ªå‘¨æœŸçš„æ•°æ®")
```

#### 2. å®æ—¶è¿è¡Œï¼ˆREALTIME æ¨¡å¼ï¼‰

```python
from data_manager import RealtimeConfig, HistoryConfig

# åˆ›å»ºå¼•æ“
engine = UnifiedEngine.from_program_config(config)

# å¯ç”¨å®æ—¶æ•°æ®ç®¡ç†ï¼ˆæ¨é€åˆ° Redisï¼‰
engine.enable_realtime_data(RealtimeConfig(
    redis_host="localhost",
    redis_port=6379,
    pubsub_channel="data_factory"
))

# å¯ç”¨å†å²æ•°æ®å­˜å‚¨ï¼ˆå­˜å‚¨åˆ° DuckDBï¼‰
engine.enable_history_storage(HistoryConfig(
    db_path="engine_history.duckdb"
))

# å®æ—¶è¿è¡Œ
try:
    for snapshot in engine.run_realtime():
        # è‡ªåŠ¨æ¨é€åˆ° Redisï¼ˆæ¯ä¸ªå‘¨æœŸï¼‰
        # è‡ªåŠ¨å­˜å‚¨åˆ° DuckDBï¼ˆåªåœ¨ need_sample=True æ—¶ï¼‰
        process(snapshot)
except KeyboardInterrupt:
    print("åœæ­¢è¿è¡Œ")
```

#### 3. å¯åŠ¨ OPCUA Server

```bash
# ç‹¬ç«‹å¯åŠ¨ OPCUA Server
python -m data_manager.run_opcua_server

# æˆ–å¸¦å‚æ•°å¯åŠ¨
python -m data_manager.run_opcua_server \
    --server-url opc.tcp://0.0.0.0:18951 \
    --redis-host localhost \
    --redis-port 6379
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    UnifiedEngine                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  Clock   â”‚  â”‚ Variable â”‚  â”‚ Expressionâ”‚            â”‚
â”‚  â”‚          â”‚  â”‚  Store   â”‚  â”‚  Nodes   â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â”‚                    â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚GENERATORâ”‚         â”‚ REALTIME   â”‚      â”‚ Data Managerâ”‚
    â”‚  Mode   â”‚         â”‚   Mode     â”‚      â”‚             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                    â”‚                    â”‚
         â”‚                    â”‚                    â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚  List   â”‚         â”‚ Generator â”‚      â”‚  Redis +    â”‚
    â”‚ Return  â”‚         â”‚  Return   â”‚      â”‚  DuckDB +   â”‚
    â”‚         â”‚         â”‚            â”‚      â”‚  OPCUA      â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµ

**GENERATOR æ¨¡å¼**ï¼š
```
é…ç½®æ–‡ä»¶ â†’ DSLParser â†’ UnifiedEngine â†’ run_generator(n) â†’ List[Snapshot]
```

**REALTIME æ¨¡å¼**ï¼š
```
é…ç½®æ–‡ä»¶ â†’ UnifiedEngine â†’ run_realtime() â†’ Generator[Snapshot]
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚               â”‚               â”‚
              Redis (å®æ—¶)    DuckDB (å†å²)    OPCUA Server
```

### ç›®å½•ç»“æ„

```
data_factory_next/
â”œâ”€â”€ core/                    # æ ¸å¿ƒå¼•æ“æ¨¡å—
â”‚   â”œâ”€â”€ clock.py             # ç»Ÿä¸€æ—¶é’Ÿç®¡ç†
â”‚   â”œâ”€â”€ variable.py          # å˜é‡å­˜å‚¨ä¸å†å²ç¼“å†²åŒº
â”‚   â”œâ”€â”€ expression.py        # è¡¨è¾¾å¼æ‰§è¡Œå¼•æ“
â”‚   â”œâ”€â”€ parser.py            # DSL é…ç½®è§£æå™¨
â”‚   â”œâ”€â”€ factory.py           # å®ä¾‹å·¥å‚
â”‚   â””â”€â”€ engine.py            # ç»Ÿä¸€æ‰§è¡Œå¼•æ“
â”œâ”€â”€ data_manager/            # æ•°æ®ç®¡ç†æ¨¡å—
â”‚   â”œâ”€â”€ realtime_manager.py  # Redis å®æ—¶æ•°æ®ç®¡ç†
â”‚   â”œâ”€â”€ history_storage.py   # DuckDB å†å²æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ opcua_server.py      # OPCUA Server
â”‚   â””â”€â”€ run_opcua_server.py  # OPCUA Server å¯åŠ¨è„šæœ¬
â”œâ”€â”€ programs/                # ç¨‹åºç±»å‹ï¼ˆç®—æ³•/æ¨¡å‹ï¼‰
â”‚   â”œâ”€â”€ base.py             # åŸºç¡€ç¨‹åºç±»
â”‚   â”œâ”€â”€ pid.py              # PID æ§åˆ¶ç®—æ³•
â”‚   â”œâ”€â”€ sin.py              # æ­£å¼¦æ³¢ç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ valve.py            # é˜€é—¨æ¨¡å‹
â”‚   â””â”€â”€ ...
â”œâ”€â”€ functions/               # æ•°å­¦å‡½æ•°åº“
â”‚   â””â”€â”€ math_functions.py   # æ•°å­¦å‡½æ•°å®ç°
â”œâ”€â”€ config/                 # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ display_demo.yaml   # ç¤ºä¾‹é…ç½®
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/                  # å·¥å…·æ¨¡å—
â”‚   â””â”€â”€ logger.py           # æ—¥å¿—ç®¡ç†
â””â”€â”€ doc/                    # é¡¹ç›®æ–‡æ¡£
    â”œâ”€â”€ è®¾è®¡æ–‡æ¡£.md
    â”œâ”€â”€ ç”¨æˆ·æ‰‹å†Œ.md
    â””â”€â”€ ...
```

## ğŸ“ é…ç½®ç¤ºä¾‹

### DSL é…ç½®æ–‡ä»¶æ ¼å¼

```yaml
# config/display_demo.yaml
cycle_time: 0.5              # æ‰§è¡Œå‘¨æœŸï¼ˆç§’ï¼‰
sample_interval: 5.0         # é‡‡æ ·é—´éš”ï¼ˆç§’ï¼‰ï¼Œå¯é€‰
start_time: 0.0              # èµ·å§‹æ—¶é—´
time_format: "%Y-%m-%d %H:%M:%S"  # æ—¶é—´æ ¼å¼

program:
  # ç®—æ³•/æ¨¡å‹å®ä¾‹
  - name: sin1
    type: SIN
    init_args:
      amplitude: 100.0
      period: 1200
      phase: 0.0
    expression: sin1.execute()
  
  - name: valve1
    type: VALVE
    init_args:
      min_opening: 0.0
      max_opening: 100.0
      step: 0.1
      full_travel_time: 10.0
    expression: valve1.execute(target_opening=sin1.out)
  
  # å˜é‡è¡¨è¾¾å¼
  - name: non_sense_3
    type: Variable
    expression: non_sense_3 = non_sense_1[-30] + 2 * sqrt(non_sense_2)
```

### è¡¨è¾¾å¼è¯­æ³•

- **æ•°å­¦å‡½æ•°**ï¼š`sin()`, `cos()`, `sqrt()`, `log()`, `exp()` ç­‰
- **æ–¹æ³•è°ƒç”¨**ï¼š`pid1.execute()`, `tank1.step()`
- **å±æ€§è®¿é—®**ï¼š`sin1.out`, `pid1.mv`
- **å†å²æ•°æ®è®¿é—®**ï¼š`variable[-N]`ï¼ˆè®¿é—® N ä¸ªå‘¨æœŸå‰çš„å€¼ï¼‰

## ğŸ’¾ æ•°æ®ç®¡ç†

### å®æ—¶æ•°æ®ç®¡ç†ï¼ˆRedisï¼‰

**åŠŸèƒ½**ï¼š
- æ¯ä¸ªå‘¨æœŸè‡ªåŠ¨æ¨é€æ•°æ®åˆ° Redis
- æ›´æ–° `data_factory:current` é”®ï¼ˆæœ€æ–°æ•°æ®ï¼‰
- å‘å¸ƒé€šçŸ¥åˆ° Pub/Sub é¢‘é“ï¼ˆé€šçŸ¥ OPCUA æ¨¡å—ï¼‰

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```python
from data_manager import RealtimeConfig

engine.enable_realtime_data(RealtimeConfig(
    redis_host="localhost",
    redis_port=6379,
    pubsub_channel="data_factory"
))
```

**Redis æ•°æ®ç»“æ„**ï¼š
```json
// data_factory:current
{
    "timestamp": 1234567890.123,
    "datetime": "2024-12-06 10:30:45",
    "cycle_count": 100,
    "sim_time": 50.0,
    "params": {
        "tank1.level": 50.5,
        "pid1.mv": 30.0,
        ...
    }
}
```

### å†å²æ•°æ®å­˜å‚¨ï¼ˆDuckDBï¼‰

**åŠŸèƒ½**ï¼š
- åŸºäº DuckDB çš„é«˜æ€§èƒ½æ—¶åºæ•°æ®å­˜å‚¨
- æŒ‰é‡‡æ ·å‘¨æœŸè‡ªåŠ¨å­˜å‚¨ï¼ˆä½¿ç”¨ Clock çš„ `need_sample`ï¼‰
- æ‰¹é‡æ’å…¥ä¼˜åŒ–ï¼ˆæ¯100æ¡è®°å½•æ‰¹é‡æ’å…¥ï¼‰
- æ”¯æŒå†å²æŸ¥è¯¢ã€é‡‡æ ·æŸ¥è¯¢ã€ç»Ÿè®¡æŸ¥è¯¢

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
```python
from data_manager import HistoryConfig

engine.enable_history_storage(HistoryConfig(
    db_path="engine_history.duckdb"
))

# æŸ¥è¯¢å†å²æ•°æ®
history_storage = engine._history_storage
records = history_storage.query_history(
    param_name="tank1.level",
    limit=100
)

# é‡‡æ ·æŸ¥è¯¢ï¼ˆæ¯60ç§’é‡‡æ ·ä¸€æ¬¡ï¼‰
sampled = history_storage.query_sampled(
    param_name="tank1.level",
    sample_interval=60.0,
    limit=1000
)

# ç»Ÿè®¡æŸ¥è¯¢
stats = history_storage.get_statistics("tank1.level")
print(f"count={stats['count']}, avg={stats['avg']:.2f}")
```

### OPCUA Server

**åŠŸèƒ½**ï¼š
- ç‹¬ç«‹çš„ OPCUA Serverï¼Œå¯ç‹¬ç«‹å¯åŠ¨
- è‡ªåŠ¨ä» Redis è¯»å–æ•°æ®å¹¶æ›´æ–°èŠ‚ç‚¹
- èŠ‚ç‚¹çš„ nameã€display_nameã€browse_nameã€node_id éƒ½ä½¿ç”¨ä½å·å
- æ”¯æŒåŠ¨æ€èŠ‚ç‚¹åˆ›å»º

**å¯åŠ¨æ–¹å¼**ï¼š
```bash
python -m data_manager.run_opcua_server
```

**èŠ‚ç‚¹ç»“æ„**ï¼š
```
Objects/
  â””â”€â”€ DataFactory/
      â”œâ”€â”€ tank1.level
      â”œâ”€â”€ pid1.mv
      â”œâ”€â”€ pid1.pv
      â””â”€â”€ valve1.current_opening
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### æ ¸å¿ƒä¾èµ–

- **Python 3.10+**ï¼šä¸»è¦ç¼–ç¨‹è¯­è¨€
- **PyYAML**ï¼šYAML é…ç½®æ–‡ä»¶è§£æ
- **Pandas**ï¼šæ•°æ®å¤„ç†ï¼ˆç”¨äºæ•°æ®å¯¼å‡ºï¼‰
- **NumPy**ï¼šæ•°å€¼è®¡ç®—æ”¯æŒ

### æ•°æ®ç®¡ç†

- **Redis**ï¼šå®æ—¶æ•°æ®å­˜å‚¨å’Œ Pub/Sub é€šçŸ¥
- **DuckDB**ï¼šé«˜æ€§èƒ½æ—¶åºæ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢
- **asyncua**ï¼šOPCUA Server å®ç°

### è®¾è®¡ç‰¹ç‚¹

- **æ¨¡å—åŒ–æ¶æ„**ï¼šæ¸…æ™°çš„æ¨¡å—åˆ’åˆ†ï¼Œæ˜“äºæ‰©å±•
- **ç±»å‹å®‰å…¨**ï¼šä½¿ç”¨ç±»å‹æ³¨è§£æé«˜ä»£ç å¯è¯»æ€§
- **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‰¹é‡æ’å…¥ã€è¿æ¥æ± ã€æŒ‰éœ€å­˜å‚¨ç­‰ä¼˜åŒ–ç­–ç•¥

## ğŸ¯ åº”ç”¨åœºæ™¯

### 1. å·¥ä¸šå¤§æ¨¡å‹æµ‹è¯•
- ç”Ÿæˆç¬¦åˆå·¥ä¸šåœºæ™¯çš„æ—¶é—´åºåˆ—æ•°æ®
- æ”¯æŒå¤æ‚çš„æ•°æ®å…³ç³»æ¨¡å¼ï¼ˆæ—¶é—´è§„å¾‹ã€æ»åè·Ÿéšã€å¤šé¡¹å¼å…³ç³»ç­‰ï¼‰
- æ‰¹é‡ç”Ÿæˆå¤§è§„æ¨¡æµ‹è¯•æ•°æ®é›†

### 2. PLC ä»¿çœŸä¸è”è°ƒ
- å®æ—¶è¿è¡Œæ¨¡å¼ï¼Œæ¨¡æ‹Ÿ PLC å‘¨æœŸæ‰§è¡Œ
- OPCUA é›†æˆï¼Œä¸å¤–éƒ¨ç³»ç»Ÿæ— ç¼å¯¹æ¥
- æ”¯æŒç‰©ç†æ¨¡å‹å’Œæ§åˆ¶ç®—æ³•çš„ä»¿çœŸ

### 3. æ•°æ®åˆ†æä¸éªŒè¯
- å†å²æ•°æ®å­˜å‚¨å’ŒæŸ¥è¯¢
- æ•°æ®ç»Ÿè®¡å’Œåˆ†æ
- é‡‡æ ·æŸ¥è¯¢æ”¯æŒå¤§æ•°æ®é›†åˆ†æ

### 4. ç³»ç»Ÿé›†æˆæµ‹è¯•
- å®æ—¶æ•°æ®æ¨é€ï¼ˆRedisï¼‰
- OPCUA æ ‡å‡†åè®®æ”¯æŒ
- çµæ´»çš„é…ç½®å’Œæ‰©å±•èƒ½åŠ›

## ğŸ“š æ–‡æ¡£

- [è®¾è®¡æ–‡æ¡£](doc/è®¾è®¡æ–‡æ¡£.md) - ç³»ç»Ÿæ¶æ„å’Œè®¾è®¡ç†å¿µ
- [ç”¨æˆ·æ‰‹å†Œ](doc/ç”¨æˆ·æ‰‹å†Œ.md) - ä½¿ç”¨æŒ‡å—å’Œ API å‚è€ƒ
- [éœ€æ±‚æ–‡æ¡£](doc/éœ€æ±‚æ–‡æ¡£.md) - åŠŸèƒ½éœ€æ±‚è¯´æ˜
- [DSL è§„åˆ™](doc/dsl_rules.md) - DSL é…ç½®è¯­æ³•è¯´æ˜
- [äº¤äº’è®°å½•](doc/interaction_record.md) - å¼€å‘å†ç¨‹å’Œè®¾è®¡å†³ç­–

## ğŸ”„ è¿è¡Œæ¨¡å¼å¯¹æ¯”

| ç‰¹æ€§ | GENERATOR æ¨¡å¼ | REALTIME æ¨¡å¼ |
|------|---------------|---------------|
| **æ‰§è¡Œé€Ÿåº¦** | å¿«é€Ÿï¼Œä¸ sleep | å®æ—¶ï¼ŒæŒ‰å‘¨æœŸ sleep |
| **è¿”å›å€¼** | `List[Dict]` | `Iterable[Dict]` (ç”Ÿæˆå™¨) |
| **æ•°æ®ä¿ç•™** | ä¿ç•™æ‰€æœ‰æ•°æ® | æµå¼å¤„ç†ï¼Œä¸ä¿ç•™ |
| **é€‚ç”¨åœºæ™¯** | æ‰¹é‡ç”Ÿæˆã€æµ‹è¯•ã€ç¦»çº¿åˆ†æ | å®æ—¶è¿è¡Œã€åœ¨çº¿äº¤äº’ã€ç³»ç»Ÿé›†æˆ |
| **å†…å­˜å ç”¨** | é«˜ï¼ˆæ‰€æœ‰æ•°æ®åœ¨å†…å­˜ï¼‰ | ä½ï¼ˆåªä¿ç•™å½“å‰å¿«ç…§ï¼‰ |

## ğŸ“¦ ä¾èµ–å®‰è£…

```bash
# å®‰è£…æ‰€æœ‰ä¾èµ–
pip install -r requirements.txt

# æ ¸å¿ƒä¾èµ–
pip install pyyaml pandas numpy

# æ•°æ®ç®¡ç†ä¾èµ–ï¼ˆå¯é€‰ï¼‰
pip install redis duckdb asyncua
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

**Data Factory Next** - è®©å·¥ä¸šæ•°æ®ç”Ÿæˆå’Œæ¨¡æ‹Ÿæ›´ç®€å•ã€æ›´é«˜æ•ˆï¼